name: ðŸ” ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬

on:
  push:
    branches: [ main, develop ]  # Git Flowì— ë§žê²Œ develop ì‚¬ìš©
  pull_request:
    types: [opened, synchronize, reopened]

permissions:
  contents: read
  pull-requests: write    # PR ëŒ“ê¸€ ê¶Œí•œ
  checks: write          # ì²´í¬ ìƒíƒœ ì—…ë°ì´íŠ¸ ê¶Œí•œ

jobs:
  ci:
    name: ðŸ“‹ í’ˆì§ˆ ê²€ì‚¬
    runs-on: ubuntu-latest
    timeout-minutes: 15
    
    steps:
      - name: ðŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4

      - name: ðŸŸ¢ Node.js 22.12.0 ì„¤ì •
        uses: actions/setup-node@v4
        with:
          node-version: '22.12.0'
          cache: 'npm'
          cache-dependency-path: 'package-lock.json'

      - name: ðŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
        run: npm ci

      - name: ðŸ” ë¦°íŠ¸ ê²€ì‚¬
        run: npm run lint

      - name: ðŸŽ¯ íƒ€ìž… ê²€ì‚¬  
        run: npm run typecheck

      - name: ðŸ—ï¸ ë¹Œë“œ ê²€ì‚¬
        run: npm run build
        env:
          NODE_ENV: production

      - name: ðŸ“Š ê²€ì‚¬ ê²°ê³¼ ìš”ì•½
        if: always()
        run: |
          echo "## ðŸ” CI ê²€ì‚¬ ê²°ê³¼" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… ì˜ì¡´ì„± ì„¤ì¹˜ ì™„ë£Œ" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… ë¦°íŠ¸ ê²€ì‚¬ ì™„ë£Œ" >> $GITHUB_STEP_SUMMARY  
          echo "- âœ… íƒ€ìž… ê²€ì‚¬ ì™„ë£Œ" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… ë¹Œë“œ ê²€ì‚¬ ì™„ë£Œ" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Next.js ë²„ì „:** $(npx next --version)" >> $GITHUB_STEP_SUMMARY
          echo "**Node.js ë²„ì „:** $(node --version)" >> $GITHUB_STEP_SUMMARY
